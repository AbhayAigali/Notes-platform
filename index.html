<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Notes Platform</title>
    <meta name="viewport" content="width=device-width,initial-scale=1" />

    <style>
        /* =====================================
           BASE STYLES
        ====================================== */
        body { 
            font-family: Arial, sans-serif; 
            margin: 0; 
            background:#f7f7f7; 
            color:#333; 
            overflow-x: hidden;
            transition: background 0.4s ease, color 0.4s ease;
        }

        header { 
            background: linear-gradient(135deg,#6a11cb,#2575fc); 
            color:#fff; 
            padding:25px; 
            text-align:center; 
            font-size:26px; 
            font-weight:700; 
            transform: translateY(-40px);
            opacity: 0;
            animation: headerIn 0.9s ease forwards;
        }

        @keyframes headerIn {
            to { transform: translateY(0); opacity: 1; }
        }

        #searchBar { 
            width:90%; 
            max-width:600px; 
            margin:18px auto; 
            display:block; 
            padding:12px; 
            border-radius:10px; 
            border:1px solid #ccc; 
            font-size:16px;
            opacity: 0;
            transform: scale(0.8);
            animation: searchPop 0.6s ease forwards 0.4s;
        }

        @keyframes searchPop {
            to { transform: scale(1); opacity: 1; }
        }

        .category-title { 
            font-size:22px; 
            font-weight:700; 
            margin:24px 0 8px 12px; 
            color:#333; 
            opacity: 0;
            transform: translateX(-20px);
            transition: color 0.3s ease;
        }

        .note-box { 
            background:#fff; 
            padding:14px; 
            border-radius:12px; 
            margin:10px; 
            box-shadow:0 4px 10px rgba(0,0,0,0.08); 
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            opacity: 0;
            transform: translateY(20px);
        }

        .note-box:hover {
            transform: translateY(-6px);
            box-shadow: 0 6px 14px rgba(0,0,0,0.15);
        }

        .download-btn { 
            display:inline-block; 
            margin-top:10px; 
            padding:10px 14px; 
            background:linear-gradient(135deg,#ff9966,#ff5e62); 
            color:#fff; 
            border-radius:8px; 
            text-decoration:none; 
            font-weight:700;
            position: relative;
            overflow: hidden;
            transition: transform 0.25s ease;
        }

        .download-btn:hover {
            transform: scale(1.05);
        }

        /* Ripple effect */
        .download-btn:active::after {
            content:'';
            position:absolute;
            left:50%;
            top:50%;
            width:200%;
            height:200%;
            background:rgba(255,255,255,0.4);
            transform:translate(-50%,-50%);
            border-radius:50%;
            animation:ripple 0.5s ease-out;
        }

        @keyframes ripple {
            from { transform: translate(-50%, -50%) scale(0); opacity: 0.7;}
            to   { transform: translate(-50%, -50%) scale(1); opacity: 0;}
        }

        .empty { color:#777; margin-left:12px; font-style:italic; }

        main { max-width:1100px; margin:0 auto 60px; padding:10px;}

        /* =====================================
           DARK MODE
        ====================================== */
        body.dark {
            background:#0f0f0f;
            color:#e6e6e6;
        }

        body.dark header {
            background: linear-gradient(135deg, #1a1a1a, #333);
        }

        body.dark #searchBar {
            background:#1a1a1a;
            color:#fff;
            border:1px solid #555;
        }

        body.dark .category-title { color:#fff; }

        body.dark .note-box {
            background:#1a1a1a;
            box-shadow:0 4px 12px rgba(255,255,255,0.08);
        }

        body.dark .download-btn {
            background:linear-gradient(135deg,#ff5e62,#c0392b);
        }

        /* =====================================
           DARK MODE BUTTON
        ====================================== */
        .toggle-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 10px 16px;
            font-size: 15px;
            font-weight: 600;
            border-radius: 10px;
            cursor: pointer;
            transition: 0.3s ease;
            border: 1px solid #888;
            background: white;
            color: black;
            z-index: 999;
        }

        body.dark .toggle-btn {
            background: #222;
            color: #fff;
            border-color: #555;
        }

        /* =====================================
           CUSTOM CURSOR GLOW
        ====================================== */
        .cursor-glow {
            position: fixed;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            pointer-events: none;
            background: rgba(0, 150, 255, 0.35);
            box-shadow: 0 0 20px rgba(0,150,255,0.6);
            transform: translate(-50%, -50%);
            transition: 0.1s linear;
            z-index: 2000;
        }
    </style>
</head>

<body>
<header>üìò Notes Platform</header>

<button id="darkToggle" class="toggle-btn">üåô Dark Mode</button>

<!-- Cursor Glow -->
<div class="cursor-glow"></div>

<main>
    <input type="text" id="searchBar" placeholder="Search notes or categories...">
    <div id="content"></div>
</main>

<script>
/* =====================================
       CUSTOM CURSOR FOLLOWING
===================================== */
const glow = document.querySelector(".cursor-glow");
document.addEventListener("mousemove", e => {
    glow.style.left = e.pageX + "px";
    glow.style.top = e.pageY + "px";
});

/* =====================================
       LOAD MANIFEST.JSON
===================================== */
async function fetchManifest() {
  try {
    const res = await fetch("notes/manifest.json", { cache: "no-store" });
    if (!res.ok) throw new Error("manifest not found");
    return await res.json();
  } catch (err) {
    console.error("Failed to load manifest:", err);
    return null;
  }
}

function createCard(pdf) {
  return `
    <div class="note-box" data-name="${pdf.name.toLowerCase()}" data-category="${(pdf._category||'').toLowerCase()}">
      <h3 style="margin:0 0 6px 0;">${pdf.name}</h3>
      ${pdf.size ? `<p style="margin:0;color:#bbb">Size: ${pdf.size}</p>` : ''}
      <a href="notes/${pdf.file}" class="download-btn" target="_blank" download>Download PDF</a>
    </div>
  `;
}

/* =====================================
       RENDER WITH ANIMATIONS
===================================== */
function render(manifest) {
    const content = document.getElementById("content");
    content.innerHTML = "";

    if (!manifest) {
        content.innerHTML = '<p class="empty">No notes found.</p>';
        return;
    }

    let delay = 0;

    for (const [category, arr] of Object.entries(manifest)) {

        const title = document.createElement("div");
        title.className = "category-title";
        title.textContent = category;
        title.style.animation = `fadeCat 0.6s ease forwards ${delay}s`;
        content.appendChild(title);

        delay += 0.15;

        if (!arr.length) continue;

        arr.forEach(pdf => {
            pdf._category = category;
            const box = document.createElement("div");
            box.innerHTML = createCard(pdf);
            const card = box.firstElementChild;

            card.style.animation = `stagger 0.6s ease forwards ${delay}s`;
            delay += 0.12;

            content.appendChild(card);
        });
    }
}

/* Keyframes for stagger */
const style = document.createElement("style");
style.innerHTML = `
@keyframes stagger {
    to { opacity: 1; transform: translateY(0); }
}
@keyframes fadeCat {
    to { opacity: 1; transform: translateX(0); }
}
`;
document.head.appendChild(style);

/* =====================================
       SEARCH FILTER
===================================== */
function applySearch() {
  const q = document.getElementById("searchBar").value.trim().toLowerCase();
  document.querySelectorAll(".note-box").forEach(box => {
      const name = box.dataset.name;
      const cat = box.dataset.category;
      box.style.display = (!q || name.includes(q) || cat.includes(q)) ? "" : "none";
  });
}

/* =====================================
       DARK MODE TOGGLE
===================================== */
const toggle = document.getElementById("darkToggle");

if (localStorage.getItem("dark") === "true") {
    document.body.classList.add("dark");
    toggle.textContent = "‚òÄÔ∏è Light Mode";
}

toggle.addEventListener("click", () => {
    document.body.classList.toggle("dark");
    const isDark = document.body.classList.contains("dark");
    localStorage.setItem("dark", isDark);
    toggle.textContent = isDark ? "‚òÄÔ∏è Light Mode" : "üåô Dark Mode";
});

/* =====================================
       INIT
===================================== */
(async function init() {
  const manifest = await fetchManifest();
  render(manifest);
  document.getElementById("searchBar").addEventListener("input", applySearch);
})();
</script>

</body>
</html>
